# /* Copyright (c) SRI International 2002. */
SHELL = /bin/sh

#### configuration part
CC = @CC@
CXX = @CXX@
CFLAGS = @CFLAGS@
CXXFLAGS = @CXXFLAGS@
RANLIB=@RANLIB@
####

LIB_DIR= ../lib
ICSAT= icsat.a

#SOURCES= util.cpp fmessage.cpp safealloc.cpp UString.cpp StringBuffer.cpp errormsg.cpp error.cpp symbols.cpp \
#         LPException.cpp LPFormula.cpp fast-allocator.cpp LPSolver.cpp LPSolver_constraint_propagation.cpp \
#				 LPSolver_branching.cpp LPSolver_backtrack.cpp LPSolver_invariants.cpp LPSolver_internalization.cpp LPSolver_conflict_resolution.cpp \
#				 LPSolver_polarity_optimization.cpp LPSolver_implication_graph_optimization.cpp LPSolver_lookahead.cpp lazy-prover-front-end.cpp 

SOURCES= lazy-prover-front-end.cpp LPFormula.cpp error.cpp ics_interface.cpp util.cpp safealloc.cpp UString.cpp \
				 fmessage.cpp StringBuffer.cpp errormsg.cpp error.cpp

### ics_interface.cpp

OBJS= $(SOURCES:.cpp=.o) 

all: $(LIB_DIR)/$(ICSAT) 

$(LIB_DIR)/$(ICSAT): $(OBJS)
	rm -f $(LIB_DIR)/$(ICSAT)
	$(AR) cr $(LIB_DIR)/$(ICSAT) $(OBJS) 
	$(RANLIB) $(LIB_DIR)/$(ICSAT)

.PHONY: icsat

%.o : %.c
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $<

%.o : %.cpp
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $<

%.d: %.cpp
	@echo Making dependency file \'$@\' ... 
	@ $(SHELL) -ec '$(CC) -MM $(CPPFLAGS) $< | sed '\''s/\($*\)\.o[ :]*/\1.o $@ : /g'\'' > $@; [ -s $@ ] || rm -f $@'
	@ sed -e "s/msgs.h//g;s/consts.h//g" $@ > $@.DEP.TMP
	@ mv $@.DEP.TMP $@

include $(SOURCES:.cpp=.d)

clean:
	rm -f $(LIB_DIR)/$(ICSAT)
	rm -f *.o
	rm -f *.d
	rm -f a.out
	rm -f core


